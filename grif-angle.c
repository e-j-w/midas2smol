// gcc -g -o grif-ang grif-angle.c -lm

#include <stdio.h>
#include <stdlib.h>
#include <math.h>

#define NUM_CRYSTALS 64

float grif_crystal_theta[NUM_CRYSTALS]={
    36.5,  55.1,  55.1,  36.5,    36.5,  55.1,  55.1,  36.5,
    36.5,  55.1,  55.1,  36.5,    36.5,  55.1,  55.1,  36.5,
    80.6,  99.4,  99.4,  80.6,    80.6,  99.4,  99.4,  80.6,
    80.6,  99.4,  99.4,  80.6,    80.6,  99.4,  99.4,  80.6,
    80.6,  99.4,  99.4,  80.6,    80.6,  99.4,  99.4,  80.6,
    80.6,  99.4,  99.4,  80.6,    80.6,  99.4,  99.4,  80.6,
   124.9, 143.5, 143.5, 124.9,   124.9, 143.5, 143.5, 124.9,
   124.9, 143.5, 143.5, 124.9,   124.9, 143.5, 143.5, 124.9
};
float grif_crystal_phi[NUM_CRYSTALS]={
    83.4,  79.0,  56.0,  51.6,   173.4, 169.0, 146.0, 141.6,
   263.4, 259.0, 236.0, 231.6,   353.4, 349.0, 326.0, 321.6,
    32.0,  32.0,  13.0,  13.0,    77.0,  77.0,  58.0,  58.0,
   122.0, 122.0, 103.0, 103.0,   167.0, 167.0, 148.0, 148.0,
   212.0, 212.0, 193.0, 193.0,   257.0, 257.0, 238.0, 238.0,
   302.0, 302.0, 283.0, 283.0,   347.0, 347.0, 328.0, 328.0,
    79.0,  83.4,  51.6,  56.0,   169.0, 173.4, 141.6, 146.0,
   259.0, 263.4, 231.6, 236.0,   349.0, 353.4, 321.6, 326.0
};

int main(int argc, char *argv[])
{
   float theta, phi;
   int diff1, diff2;
   int i, j;
   for(j=0; j<NUM_CRYSTALS; j++){
      printf("%2d [ %2d%c ] : ", j+1, (int)(j/4)+1,
         (j%4==0 ? 'B' : j%4==1 ? 'G' : j%4==2 ? 'R' : 'W' )  );
      theta = grif_crystal_theta[j];
      phi   = grif_crystal_phi[j];
      for(i=0; i<NUM_CRYSTALS; i++){
         diff1 = (int)(180 - grif_crystal_theta[i] - theta + 360) % 180;
         diff2 = (int)(180 + grif_crystal_phi[i]   - phi   + 720) % 360;
         if( diff1 < 5 && diff2 < 5 ){
            printf("%2d [ %2d%c ],", i+1, (int)(i/4)+1,
               (i%4==0 ? 'B' : i%4==1 ? 'G' : i%4==2 ? 'R' : 'W' )  );
         }
      }
      printf("\n");
   }
   exit(0);
}

